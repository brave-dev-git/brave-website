---
import Layout from "../../layouts/Layout.astro";
import Header from "../../components/Header.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const posts = await getCollection("insikter");
  return posts
    .filter((p) => !p.data.draft)
    .map((p) => ({ params: { slug: p.slug }, props: { post: p } }));
}

const { post } = Astro.props;
const { Content } = await post.render();

const title = `${post.data.title} | Brave Security`;
const description = post.data.description;
---

<Layout title={title} description={description} lang="sv">
  <Header />

  <main class="container">
    <section class="section">
      <div class="section-surface">
        <div class="prose prose--article">
          <article class="article">
            <header class="head">
              <a class="link" href="/insikter">← Till Insikter</a>

              <h1 class="h1">{post.data.title}</h1>

              <div class="meta">
                <time datetime={post.data.date.toISOString()}>
                  {post.data.date.toLocaleDateString("sv-SE")}
                </time>
                {post.data.tags?.length ? <span class="dot">•</span> : null}
                {post.data.tags?.map((t) => <span class="tag">{t}</span>)}
              </div>

              <p class="lead">{post.data.description}</p>
            </header>

            <div class="content">
              <Content />
            </div>

            <section class="card cta" aria-label="Kontakt CTA">
              <h2 class="h2">Vill du bolla detta i er kontext?</h2>
              <p class="p">Hör av dig så tar vi ett kort, förutsättningslöst samtal.</p>
              <div class="cta-row">
                <a class="btn-primary" href="/kontakt">Kontakt</a>
                <a class="btn-secondary" href="/tjanster">Se tjänster</a>
              </div>
            </section>
          </article>
        </div>

        <div class="foot">© {new Date().getFullYear()} Brave Security AB</div>
      </div>
    </section>
  </main>
</Layout>


<style>
    /* Artikel-layout i samma stil som resten */
    .article {
      margin-top: 1.2rem;
    }

    /* Rytm: gör texten lättare att läsa */
    .article :is(p, ul, ol, blockquote) {
      margin: 0.9rem 0;
    }

    .article :is(h2, h3) {
      margin: 1.6rem 0 0.6rem;
    }

    .article ul, .article ol {
      padding-left: 1.2rem;
    }

    .article blockquote {
      margin: 1.2rem 0;
      padding: 0.9rem 1rem;
      border-left: 3px solid rgba(124, 58, 237, 0.7);
      background: rgba(2, 6, 23, 0.22);
      border-radius: 0.9rem;
    }

    /* Bilder i artiklar */
    .article img {
      width: 100%;
      height: auto;
      display: block;
      border-radius: 1rem;
      border: 1px solid rgba(148,163,184,0.22);
    }

    .prose--article {
        max-width: 90ch;     /* test: 86–100ch */
        margin: 0 auto;      /* centrera i ytan */
      }


  .head { margin-bottom: 1rem; }
  
  .meta { display: flex; flex-wrap: wrap; gap: 0.5rem; align-items: center; color: rgba(229,231,235,0.75); font-size: 0.85rem; }
  .dot { opacity: 0.6; }
  .tag {
    padding: 0.15rem 0.5rem;
    border-radius: 999px;
    border: 1px solid rgba(148,163,184,0.25);
    background: rgba(2,6,23,0.22);
  }

  /* enkel typografi för markdown */
  .content :global(h2) { margin-top: 1.4rem; }
  .content :global(p) { line-height: 1.8; color: rgba(229,231,235,0.9); }
  .content :global(a) { color: rgba(203,213,245,1); text-underline-offset: 4px; }
  .content :global(ul) { line-height: 1.8; }

  .cta { margin-top: 1.4rem; }
</style>
